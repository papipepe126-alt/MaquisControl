<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MaquisControl Pro</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --primary: #FFD700; /* Or */
            --accent: #FF6B6B; /* Rouge doux */
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --success: #4CAF50;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            padding-bottom: 100px; /* Espace pour le bouton du bas */
        }

        /* En-t√™te */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .brand { font-size: 22px; font-weight: 700; color: var(--primary); letter-spacing: 1px; }
        .settings-btn { background: none; border: none; color: var(--text-main); font-size: 24px; cursor: pointer; }

        /* Carte Caisse Principale */
        .dashboard-card {
            background: linear-gradient(135deg, #2c3e50, #000000);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .dashboard-card h2 { margin: 0; font-size: 14px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 2px; }
        .dashboard-card .amount { font-size: 42px; font-weight: 700; margin: 10px 0; color: var(--primary); text-shadow: 0 0 10px rgba(255, 215, 0, 0.3); }

        /* Grille des Boissons */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .drink-card {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 20px 15px;
            position: relative;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            border: 1px solid #333;
            overflow: hidden;
        }

        .drink-card:active { transform: scale(0.96); background: #2a2a2a; }

        .drink-icon { font-size: 30px; margin-bottom: 10px; color: var(--text-muted); }
        .drink-name { font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .drink-price { font-size: 14px; color: var(--success); font-weight: 700; }
        
        /* Jauge de Stock */
        .stock-indicator {
            margin-top: 15px;
            height: 4px;
            background: #333;
            border-radius: 2px;
            width: 100%;
            overflow: hidden;
        }
        .stock-level { height: 100%; background: var(--success); transition: width 0.3s; }
        .stock-text { font-size: 11px; color: var(--text-muted); margin-top: 5px; display: block; text-align: right; }

        /* Bouton Flottant WhatsApp */
        .fab {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            background: #25D366;
            color: white;
            border: none;
            padding: 18px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            z-index: 100;
        }

        /* MODAL (Fen√™tre de r√©glages) */
        .modal {
            display: none; /* Cach√© par d√©faut */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 200;
            align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: var(--card-bg); width: 90%; padding: 30px; border-radius: 20px;
            border: 1px solid #444;
        }
        .modal input {
            width: 100%; padding: 15px; margin: 10px 0;
            background: #333; border: none; color: white; border-radius: 10px; font-size: 18px;
        }
        .close-btn {
            background: var(--primary); color: black; border: none; padding: 15px; width: 100%;
            border-radius: 10px; font-weight: bold; font-size: 16px; margin-top: 10px;
        }

    </style>
</head>
<body>

    <header>
        <div class="brand"><i class="fa-solid fa-beer-mug-empty"></i> MAQUIS<span style="color:white">PRO</span></div>
        <button class="settings-btn" onclick="toggleModal()"><i class="fa-solid fa-gear"></i></button>
    </header>

    <div class="dashboard-card">
        <h2>Recette du Soir</h2>
        <div class="amount" id="total-caisse">0 FCFA</div>
        <div style="font-size: 12px; color: #666;">EN CAISSE ACTUELLEMENT</div>
    </div>

    <div class="grid">
        <div class="drink-card" onclick="vendre('Bock', 1000)">
            <div class="drink-icon" style="color: #e74c3c;"><i class="fa-solid fa-wine-bottle"></i></div>
            <div class="drink-name">Bock</div>
            <div class="drink-price">1000 F</div>
            
            <div class="stock-indicator">
                <div class="stock-level" id="bar-bock" style="width: 100%;"></div>
            </div>
            <span class="stock-text">Stock: <span id="text-bock">24</span></span>
        </div>

        <div class="drink-card" onclick="vendre('Ivoire', 1100)">
            <div class="drink-icon" style="color: #f1c40f;"><i class="fa-solid fa-wine-glass"></i></div>
            <div class="drink-name">Ivoire</div>
            <div class="drink-price">1100 F</div>
            
            <div class="stock-indicator">
                <div class="stock-level" id="bar-ivoire" style="width: 100%;"></div>
            </div>
            <span class="stock-text">Stock: <span id="text-ivoire">24</span></span>
        </div>

        <div class="drink-card" onclick="vendre('Chill', 1200)">
            <div class="drink-icon" style="color: #3498db;"><i class="fa-solid fa-bottle-droplet"></i></div>
            <div class="drink-name">Chill</div>
            <div class="drink-price">1200 F</div>
            
            <div class="stock-indicator">
                <div class="stock-level" id="bar-chill" style="width: 100%;"></div>
            </div>
            <span class="stock-text">Stock: <span id="text-chill">24</span></span>
        </div>

        <div class="drink-card" onclick="vendre('Eau', 500)">
            <div class="drink-icon" style="color: #ffffff;"><i class="fa-solid fa-glass-water"></i></div>
            <div class="drink-name">Eau</div>
            <div class="drink-price">500 F</div>
            
            <div class="stock-indicator">
                <div class="stock-level" id="bar-eau" style="width: 100%;"></div>
            </div>
            <span class="stock-text">Stock: <span id="text-eau">24</span></span>
        </div>
    </div>

    <button class="fab" onclick="genererRapport()">
        <i class="fa-brands fa-whatsapp"></i> CL√îTURER LA CAISSE
    </button>

    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <h2 style="margin-top:0">üì¶ Mise en Stock</h2>
            <p style="color:#888; font-size:12px;">Entrez le nombre de bouteilles dans le frigo.</p>
            
            <label>Bock (Qt√©)</label>
            <input type="number" id="input-bock" value="24">
            
            <label>Ivoire (Qt√©)</label>
            <input type="number" id="input-ivoire" value="24">

            <label>Chill (Qt√©)</label>
            <input type="number" id="input-chill" value="24">

            <label>Eau (Qt√©)</label>
            <input type="number" id="input-eau" value="24">

            <button class="close-btn" onclick="validerStock()">ENREGISTRER</button>
        </div>
    </div>

    <script>
        // CONFIGURATION INITIALE
        let stocks = { 'Bock': 24, 'Ivoire': 24, 'Chill': 24, 'Eau': 24 };
        let maxStocks = { 'Bock': 24, 'Ivoire': 24, 'Chill': 24, 'Eau': 24 }; // Pour la barre de progression
        let ventes = { 'Bock': 0, 'Ivoire': 0, 'Chill': 0, 'Eau': 0 };
        let totalArgent = 0;

        // Fonction pour ouvrir/fermer les r√©glages
        function toggleModal() {
            const modal = document.getElementById('settings-modal');
            modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
        }

        // Fonction pour valider le stock depuis le modal
        function validerStock() {
            stocks['Bock'] = parseInt(document.getElementById('input-bock').value);
            stocks['Ivoire'] = parseInt(document.getElementById('input-ivoire').value);
            stocks['Chill'] = parseInt(document.getElementById('input-chill').value);
            stocks['Eau'] = parseInt(document.getElementById('input-eau').value);
            
            // On m√©morise le max pour calculer le % de la barre
            maxStocks = {...stocks}; 
            
            updateUI();
            toggleModal(); // Ferme la fen√™tre
        }

        // Fonction de vente
        function vendre(nom, prix) {
            if (stocks[nom] > 0) {
                // Logique Math√©matique
                stocks[nom]--;
                ventes[nom]++;
                totalArgent += prix;

                // Feedback Haptique (Vibration)
                if (navigator.vibrate) navigator.vibrate(50); 

                updateUI();
            } else {
                // Vibration d'erreur (longue)
                if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
                alert("‚õî STOCK √âPUIS√â : " + nom);
            }
        }

        // Mise √† jour de toute l'interface
        function updateUI() {
            // Mise √† jour du Total
            // .toLocaleString() permet d'avoir les espaces (ex: 10 000 au lieu de 10000)
            document.getElementById("total-caisse").innerText = totalArgent.toLocaleString() + " FCFA";

            // Mise √† jour des barres et textes pour chaque boisson
            updateCard('bock', 'Bock');
            updateCard('ivoire', 'Ivoire');
            updateCard('chill', 'Chill');
            updateCard('eau', 'Eau');
        }

        function updateCard(idSuffix, nameKey) {
            let current = stocks[nameKey];
            let max = maxStocks[nameKey] || 1; // Evite division par zero
            let percent = (current / max) * 100;

            // Texte
            document.getElementById(`text-${idSuffix}`).innerText = current;
            
            // Barre visuelle
            let bar = document.getElementById(`bar-${idSuffix}`);
            bar.style.width = percent + "%";

            // Changement de couleur si stock bas
            if (percent < 20) {
                bar.style.backgroundColor = "#ff4444"; // Rouge
            } else if (percent < 50) {
                bar.style.backgroundColor = "#ffbb33"; // Orange
            } else {
                bar.style.backgroundColor = "#4CAF50"; // Vert
            }
        }

        function genererRapport() {
            let date = new Date().toLocaleDateString();
            let heure = new Date().toLocaleTimeString();
            let msg = `*üìä RAPPORT MAQUISPRO - ${date} ${heure}* %0a%0a`;
            
            msg += `üí∞ CAISSE : *${totalArgent.toLocaleString()} FCFA* %0a`;
            msg += `------------------%0a`;
            
            for (let [boisson, qte] of Object.entries(ventes)) {
                if(qte > 0 || stocks[boisson] < 5) { // Affiche si vendu ou si stock critique
                     msg += `üç∫ *${boisson}* : Vendu ${qte} | Reste ${stocks[boisson]} %0a`;
                }
            }
            
            msg += `------------------%0a`;
            msg += `Valid√© par le g√©rant.`;

            window.open(`https://wa.me/?text=${msg}`, '_blank');
        }

        // Initialisation
        updateUI();

    </script>
</body>
</html>
